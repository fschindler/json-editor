/*! For license information please see 5050.c5d6846a.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkjson_editor=self.webpackChunkjson_editor||[]).push([[5050],{"./packages/rje-code-widgets/src/lib/jsonwidget/JsonWidget.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{jb:()=>JsonWidget,N8:()=>JsonWidgetPlugin});var index_modern=__webpack_require__("./node_modules/markdown-to-jsx/dist/index.modern.js"),react=__webpack_require__("./node_modules/react/index.js"),esm=__webpack_require__("./node_modules/@uiw/react-codemirror/esm/index.js"),dist=__webpack_require__("./node_modules/@codemirror/lang-json/dist/index.js"),src=__webpack_require__("./packages/react-json-editor/src/index.ts"),client=__webpack_require__("./node_modules/react-dom/client.js"),dist_module=__webpack_require__("./node_modules/json-schema-library/dist/module/index.js"),jsonPointer=__webpack_require__("./node_modules/@sagold/json-pointer/dist/jsonPointer.js"),jsonPointer_default=__webpack_require__.n(jsonPointer),language_dist=__webpack_require__("./node_modules/@codemirror/language/dist/index.js");function getValue(doc,cursor){return doc.sliceString(cursor.from,cursor.to)}function getPropertyName(doc,cursor){if("Property"!==cursor.node.name)throw new Error("Cannot resolve property name of none property: ".concat(cursor.node.name));var propertyCursor=cursor.node.cursor();return propertyCursor.next(),doc.sliceString(propertyCursor.from+1,propertyCursor.to-1)}function isWithinNode(cursor,position){return cursor.from<=position&&position<=cursor.to}var STEP_INTO_NODE=["JsonText","Property","Object","Array"];function getJsonPointerFromPosition(state,position){var tree=(0,language_dist.qz)(state);return getJsonPointerFromCursor(state.doc,tree.cursor(),position)}function getJsonPointerFromCursor(doc,cursor,from){var pointer=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",nodeType=cursor.node.name;if(isWithinNode(cursor,from))return STEP_INTO_NODE.includes(nodeType)?(cursor.next(),getJsonPointerFromCursor(doc,cursor,from,pointer)):"PropertyName"===nodeType?{pointer,cursor,location:"property"}:{pointer,cursor,location:"value"};for(var isArray="["===cursor.node.name,childIndex=0;cursor.nextSibling();){if(isWithinNode(cursor,from)){if("Property"===cursor.node.name){var propertyName=getPropertyName(doc,cursor);return getJsonPointerFromCursor(doc,cursor,from,"".concat(pointer,"/").concat(propertyName))}return getJsonPointerFromCursor(doc,cursor,from,isArray?"".concat(pointer,"/").concat(childIndex):pointer)}childIndex++}return"}"===cursor.node.name?{pointer,cursor,location:"object"}:"]"===cursor.node.name?{pointer,cursor,location:"array"}:{pointer,cursor,location:"outside"}}var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");function _regeneratorRuntime(){_regeneratorRuntime=function _regeneratorRuntime(){return exports};var exports={},Op=Object.prototype,hasOwn=Op.hasOwnProperty,defineProperty=Object.defineProperty||function(obj,key,desc){obj[key]=desc.value},$Symbol="function"==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||"@@iterator",asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator",toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";function define(obj,key,value){return Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}),obj[key]}try{define({},"")}catch(err){define=function define(obj,key,value){return obj[key]=value}}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator,generator=Object.create(protoGenerator.prototype),context=new Context(tryLocsList||[]);return defineProperty(generator,"_invoke",{value:makeInvokeMethod(innerFn,self,context)}),generator}function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}exports.wrap=wrap;var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};define(IteratorPrototype,iteratorSymbol,(function(){return this}));var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);function defineIteratorMethods(prototype){["next","throw","return"].forEach((function(method){define(prototype,method,(function(arg){return this._invoke(method,arg)}))}))}function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if("throw"!==record.type){var result=record.arg,value=result.value;return value&&"object"==_typeof(value)&&hasOwn.call(value,"__await")?PromiseImpl.resolve(value.__await).then((function(value){invoke("next",value,resolve,reject)}),(function(err){invoke("throw",err,resolve,reject)})):PromiseImpl.resolve(value).then((function(unwrapped){result.value=unwrapped,resolve(result)}),(function(error){return invoke("throw",error,resolve,reject)}))}reject(record.arg)}var previousPromise;defineProperty(this,"_invoke",{value:function value(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl((function(resolve,reject){invoke(method,arg,resolve,reject)}))}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(innerFn,self,context){var state="suspendedStart";return function(method,arg){if("executing"===state)throw new Error("Generator is already running");if("completed"===state){if("throw"===method)throw arg;return doneResult()}for(context.method=method,context.arg=arg;;){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult}}if("next"===context.method)context.sent=context._sent=context.arg;else if("throw"===context.method){if("suspendedStart"===state)throw state="completed",context.arg;context.dispatchException(context.arg)}else"return"===context.method&&context.abrupt("return",context.arg);state="executing";var record=tryCatch(innerFn,self,context);if("normal"===record.type){if(state=context.done?"completed":"suspendedYield",record.arg===ContinueSentinel)continue;return{value:record.arg,done:context.done}}"throw"===record.type&&(state="completed",context.method="throw",context.arg=record.arg)}}}function maybeInvokeDelegate(delegate,context){var methodName=context.method,method=delegate.iterator[methodName];if(void 0===method)return context.delegate=null,"throw"===methodName&&delegate.iterator.return&&(context.method="return",context.arg=void 0,maybeInvokeDelegate(delegate,context),"throw"===context.method)||"return"!==methodName&&(context.method="throw",context.arg=new TypeError("The iterator does not provide a '"+methodName+"' method")),ContinueSentinel;var record=tryCatch(method,delegate.iterator,context.arg);if("throw"===record.type)return context.method="throw",context.arg=record.arg,context.delegate=null,ContinueSentinel;var info=record.arg;return info?info.done?(context[delegate.resultName]=info.value,context.next=delegate.nextLoc,"return"!==context.method&&(context.method="next",context.arg=void 0),context.delegate=null,ContinueSentinel):info:(context.method="throw",context.arg=new TypeError("iterator result is not an object"),context.delegate=null,ContinueSentinel)}function pushTryEntry(locs){var entry={tryLoc:locs[0]};1 in locs&&(entry.catchLoc=locs[1]),2 in locs&&(entry.finallyLoc=locs[2],entry.afterLoc=locs[3]),this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal",delete record.arg,entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}],tryLocsList.forEach(pushTryEntry,this),this.reset(!0)}function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod.call(iterable);if("function"==typeof iterable.next)return iterable;if(!isNaN(iterable.length)){var i=-1,next=function next(){for(;++i<iterable.length;)if(hasOwn.call(iterable,i))return next.value=iterable[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return next.next=next}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,defineProperty(Gp,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),defineProperty(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,toStringTagSymbol,"GeneratorFunction"),exports.isGeneratorFunction=function(genFun){var ctor="function"==typeof genFun&&genFun.constructor;return!!ctor&&(ctor===GeneratorFunction||"GeneratorFunction"===(ctor.displayName||ctor.name))},exports.mark=function(genFun){return Object.setPrototypeOf?Object.setPrototypeOf(genFun,GeneratorFunctionPrototype):(genFun.__proto__=GeneratorFunctionPrototype,define(genFun,toStringTagSymbol,"GeneratorFunction")),genFun.prototype=Object.create(Gp),genFun},exports.awrap=function(arg){return{__await:arg}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,asyncIteratorSymbol,(function(){return this})),exports.AsyncIterator=AsyncIterator,exports.async=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){void 0===PromiseImpl&&(PromiseImpl=Promise);var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then((function(result){return result.done?result.value:iter.next()}))},defineIteratorMethods(Gp),define(Gp,toStringTagSymbol,"Generator"),define(Gp,iteratorSymbol,(function(){return this})),define(Gp,"toString",(function(){return"[object Generator]"})),exports.keys=function(val){var object=Object(val),keys=[];for(var key in object)keys.push(key);return keys.reverse(),function next(){for(;keys.length;){var key=keys.pop();if(key in object)return next.value=key,next.done=!1,next}return next.done=!0,next}},exports.values=values,Context.prototype={constructor:Context,reset:function reset(skipTempReset){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!skipTempReset)for(var name in this)"t"===name.charAt(0)&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))&&(this[name]=void 0)},stop:function stop(){this.done=!0;var rootRecord=this.tryEntries[0].completion;if("throw"===rootRecord.type)throw rootRecord.arg;return this.rval},dispatchException:function dispatchException(exception){if(this.done)throw exception;var context=this;function handle(loc,caught){return record.type="throw",record.arg=exception,context.next=loc,caught&&(context.method="next",context.arg=void 0),!!caught}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i],record=entry.completion;if("root"===entry.tryLoc)return handle("end");if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc"),hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}else if(hasCatch){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0)}else{if(!hasFinally)throw new Error("try statement without catch or finally");if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}}}},abrupt:function abrupt(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break}}finallyEntry&&("break"===type||"continue"===type)&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc&&(finallyEntry=null);var record=finallyEntry?finallyEntry.completion:{};return record.type=type,record.arg=arg,finallyEntry?(this.method="next",this.next=finallyEntry.finallyLoc,ContinueSentinel):this.complete(record)},complete:function complete(record,afterLoc){if("throw"===record.type)throw record.arg;return"break"===record.type||"continue"===record.type?this.next=record.arg:"return"===record.type?(this.rval=this.arg=record.arg,this.method="return",this.next="end"):"normal"===record.type&&afterLoc&&(this.next=afterLoc),ContinueSentinel},finish:function finish(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc)return this.complete(entry.completion,entry.afterLoc),resetTryEntry(entry),ContinueSentinel}},catch:function _catch(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if("throw"===record.type){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(iterable,resultName,nextLoc){return this.delegate={iterator:values(iterable),resultName,nextLoc},"next"===this.method&&(this.arg=void 0),ContinueSentinel}},exports}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}var dom=document.createElement("div"),root=(0,client.createRoot)(dom);function insertValue(view,completion,from,to){var end=to;view.state.doc.sliceString(from,to).startsWith('"')&&(end+=1),view.dispatch({selection:{anchor:from+completion.label.length,head:from+completion.label.length},changes:[{from,to:end,insert:completion.label}]})}function getValueCompletions(schema){return Array.isArray(schema.enum)?schema.enum.map((function(v){var _ref;return{label:JSON.stringify(v),type:"text",info:function info(){return renderInfo(schema)},detail:null!==(_ref=schema.type)&&void 0!==_ref?_ref:_typeof(v),apply:insertValue}})):schema.const?[{label:JSON.stringify(schema.const),type:"text",info:function info(){return renderInfo(schema)},detail:null!==(_ref2=schema.type)&&void 0!==_ref2?_ref2:_typeof(schema.const),apply:insertValue}]:[];var _ref2}var jsonSchemaCompletion=function jsonSchemaCompletion(draft,schema){return function(){var _ref3=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(_regeneratorRuntime().mark((function _callee(context){var resolvedCursor,location;return _regeneratorRuntime().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return resolvedCursor=getJsonPointerFromPosition(context.state,context.pos),location=resolvedCursor.location,_context.abrupt("return",COMPLETION[location]?COMPLETION[location](draft,schema,context,resolvedCursor):null);case 3:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref3.apply(this,arguments)}}()},COMPLETION={array:function array(draft,schema,context,_ref4){var pointer=_ref4.pointer,parentSchema=draft.getSchema(pointer,getData(context),schema);if((0,dist_module.yI)(parentSchema))return console.log("failed resolving completion of 'array' on ".concat(pointer),parentSchema),null;if(Array.isArray(parentSchema.items)){var itemsSchema=parentSchema.items;return{from:context.pos,options:itemsSchema.map((function(schema){var value=draft.getTemplate(void 0,schema);return{label:JSON.stringify(value),type:"text",info:function info(){return renderInfo(schema)},detail:schema.type,apply:JSON.stringify(value)}}))}}if(parentSchema.items.oneOf){var options=draft.getChildSchemaSelection(0,parentSchema);return{from:context.pos,options:options.map((function(s,index){return{label:s.title||"".concat(index+1,". item (no title defined)"),type:"text",info:function info(){return renderInfo(s)},detail:s.type,apply:JSON.stringify(draft.getTemplate(void 0,s))}}))}}if(function isObject(value){return"[object Object]"===Object.prototype.toString.call(value)}(parentSchema.items)){var itemSchema=parentSchema.items;return{from:context.pos,options:getValueCompletions(itemSchema)}}return null},object:function object(draft,schema,context,_ref5){var _get,pointer=_ref5.pointer,data=getData(context),targetData=null!==(_get=(0,jsonPointer.get)(data,pointer))&&void 0!==_get?_get:{},parentSchema=draft.getSchema(pointer,data,schema);if((0,dist_module.yI)(parentSchema))return console.log("failed resolving completion of 'object' on ".concat(pointer),parentSchema),null;var options=[];return Object.keys(parentSchema.properties).forEach((function(prop){if(void 0===targetData[prop]){var initialValue,propertySchema=parentSchema.properties[prop];initialValue=propertySchema.const?propertySchema.const:propertySchema.enum?propertySchema.enum[0]:draft.getTemplate(void 0,propertySchema),options.push({label:'"'.concat(prop,'"'),type:"keyword",info:function info(){return renderInfo(propertySchema)},detail:propertySchema.type,apply:'"'.concat(prop,'": ').concat(JSON.stringify(initialValue))})}})),{from:context.pos,options}},outside:function outside(draft,schema,context,_ref6){var pointer=_ref6.pointer,data=getData(context),targetSchema=draft.getSchema(pointer,data,schema);return(0,dist_module.yI)(targetSchema)?(console.log("failed resolving completion of 'outside' on ".concat(pointer),targetSchema),null):{from:context.pos,options:getValueCompletions(targetSchema)}},property:function property(draft,schema,context,_ref7){var _get2,pointer=_ref7.pointer,cursor=_ref7.cursor,parentPointer=function getParentPointer(pointer){var fragments=(0,jsonPointer.split)(pointer);return fragments.pop(),(0,jsonPointer.join)(fragments)}(pointer),data=getData(context),targetData=null!==(_get2=(0,jsonPointer.get)(data,pointer))&&void 0!==_get2?_get2:{},parentSchema=draft.getSchema(parentPointer,data,schema);if((0,dist_module.yI)(parentSchema))return console.log("failed resolving completion of 'property' on ".concat(pointer),parentSchema),null;var options=[];return Object.keys(parentSchema.properties).forEach((function(prop){if(void 0===targetData[prop]){var propertySchema=parentSchema.properties[prop];options.push({label:"".concat(prop),type:"keyword",info:function info(){return renderInfo(propertySchema)},detail:propertySchema.type})}})),{from:cursor.from+1,options}},value:function value(draft,schema,context,_ref8){var pointer=_ref8.pointer,cursor=_ref8.cursor,data=getData(context),schemaOfLocation=draft.getSchema(pointer,data,schema);if((0,dist_module.yI)(schemaOfLocation))return console.log("failed resolving completion of 'value' on ".concat(pointer),schemaOfLocation),null;if(schemaOfLocation.items&&schemaOfLocation.items.oneOf){var options=draft.getChildSchemaSelection(0,schemaOfLocation);return{from:context.pos,options:options.map((function(s,index){return{label:s.title||"".concat(index+1,". item (no title defined)"),type:"text",info:function info(){return renderInfo(s)},detail:s.type,apply:JSON.stringify(draft.getTemplate(void 0,s))}}))}}return{from:cursor.from,options:getValueCompletions(schemaOfLocation)}}};function renderInfo(schema){return null==schema||null==schema.title&&null==schema.description?null:(root.render((0,jsx_runtime.jsxs)("div",{className:"rje-tooltip rje-tooltip--jsonschema",children:[schema.title&&(0,jsx_runtime.jsx)("h1",{children:schema.title}),schema.description&&(0,jsx_runtime.jsx)(index_modern.Z,{children:schema.description})]})),dom)}function getData(context){try{return JSON.parse(context.state.doc.toString())}catch(e){return}}function buildJsonPointerMap(doc,cursor){var pointer=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#",map=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},nodeType=cursor.node.name;if("JsonText"===nodeType)return cursor.next(),buildJsonPointerMap(doc,cursor,pointer,map);if("Object"===nodeType){for(cursor.next();cursor.nextSibling();)if("Property"===cursor.node.name){var location={node:cursor.node,from:cursor.from,to:cursor.to},propertyCursor=cursor.node.cursor();propertyCursor.next();var jsonName=getValue(doc,propertyCursor);map["".concat(pointer,"/").concat(JSON.parse(jsonName))]=location,propertyCursor.next(),"Object"!==propertyCursor.node.name&&"Array"!==propertyCursor.node.name||buildJsonPointerMap(doc,propertyCursor,"".concat(pointer,"/").concat(JSON.parse(jsonName)),map)}return map}if("Array"===nodeType){cursor.next();for(var index=0;cursor.nextSibling();)"]"!==cursor.node.name&&(map["".concat(pointer,"/").concat(index)]={node:cursor.node,from:cursor.from,to:cursor.to},"Object"!==cursor.node.name&&"Array"!==cursor.node.name||buildJsonPointerMap(doc,cursor,"".concat(pointer,"/").concat(index),map),index++);return map}return console.error("Unparsed node",cursor.node.name||cursor),{}}function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var jsonLintPropertyDuplicates_STEP_INTO_NODE=["JsonText","Property","PropertyName","Object","Array"];function jsonLintPropertyDuplicates(doc,cursor){var duplicates=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],nodeType=cursor.node.name;if(jsonLintPropertyDuplicates_STEP_INTO_NODE.includes(nodeType))return cursor.next(),jsonLintPropertyDuplicates(doc,cursor,duplicates);if("{"===nodeType||"["===nodeType)for(var properties={};cursor.nextSibling()&&"}"!==cursor.node.name;){if("Property"===cursor.node.name){var name=getPropertyName(doc,cursor),propertyNameCursor=cursor.node.cursor();propertyNameCursor.next();var propertyInfo={from:propertyNameCursor.from,to:propertyNameCursor.to,severity:"error",message:"Duplicated property '".concat(name,"'. Remove duplication as all previous properties with same name will removed in export.")};properties[name]&&duplicates.push(properties[name]),properties[name]=propertyInfo}duplicates.push.apply(duplicates,_toConsumableArray(jsonLintPropertyDuplicates(doc,cursor.node.cursor())))}return duplicates}function jsonSchemaLinter_typeof(obj){return jsonSchemaLinter_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},jsonSchemaLinter_typeof(obj)}function jsonSchemaLinter_toConsumableArray(arr){return function jsonSchemaLinter_arrayWithoutHoles(arr){if(Array.isArray(arr))return jsonSchemaLinter_arrayLikeToArray(arr)}(arr)||function jsonSchemaLinter_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function jsonSchemaLinter_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return jsonSchemaLinter_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jsonSchemaLinter_arrayLikeToArray(o,minLen)}(arr)||function jsonSchemaLinter_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jsonSchemaLinter_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function jsonSchemaLinter_regeneratorRuntime(){jsonSchemaLinter_regeneratorRuntime=function _regeneratorRuntime(){return exports};var exports={},Op=Object.prototype,hasOwn=Op.hasOwnProperty,defineProperty=Object.defineProperty||function(obj,key,desc){obj[key]=desc.value},$Symbol="function"==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||"@@iterator",asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator",toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";function define(obj,key,value){return Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}),obj[key]}try{define({},"")}catch(err){define=function define(obj,key,value){return obj[key]=value}}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator,generator=Object.create(protoGenerator.prototype),context=new Context(tryLocsList||[]);return defineProperty(generator,"_invoke",{value:makeInvokeMethod(innerFn,self,context)}),generator}function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}exports.wrap=wrap;var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};define(IteratorPrototype,iteratorSymbol,(function(){return this}));var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);function defineIteratorMethods(prototype){["next","throw","return"].forEach((function(method){define(prototype,method,(function(arg){return this._invoke(method,arg)}))}))}function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if("throw"!==record.type){var result=record.arg,value=result.value;return value&&"object"==jsonSchemaLinter_typeof(value)&&hasOwn.call(value,"__await")?PromiseImpl.resolve(value.__await).then((function(value){invoke("next",value,resolve,reject)}),(function(err){invoke("throw",err,resolve,reject)})):PromiseImpl.resolve(value).then((function(unwrapped){result.value=unwrapped,resolve(result)}),(function(error){return invoke("throw",error,resolve,reject)}))}reject(record.arg)}var previousPromise;defineProperty(this,"_invoke",{value:function value(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl((function(resolve,reject){invoke(method,arg,resolve,reject)}))}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(innerFn,self,context){var state="suspendedStart";return function(method,arg){if("executing"===state)throw new Error("Generator is already running");if("completed"===state){if("throw"===method)throw arg;return doneResult()}for(context.method=method,context.arg=arg;;){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult}}if("next"===context.method)context.sent=context._sent=context.arg;else if("throw"===context.method){if("suspendedStart"===state)throw state="completed",context.arg;context.dispatchException(context.arg)}else"return"===context.method&&context.abrupt("return",context.arg);state="executing";var record=tryCatch(innerFn,self,context);if("normal"===record.type){if(state=context.done?"completed":"suspendedYield",record.arg===ContinueSentinel)continue;return{value:record.arg,done:context.done}}"throw"===record.type&&(state="completed",context.method="throw",context.arg=record.arg)}}}function maybeInvokeDelegate(delegate,context){var methodName=context.method,method=delegate.iterator[methodName];if(void 0===method)return context.delegate=null,"throw"===methodName&&delegate.iterator.return&&(context.method="return",context.arg=void 0,maybeInvokeDelegate(delegate,context),"throw"===context.method)||"return"!==methodName&&(context.method="throw",context.arg=new TypeError("The iterator does not provide a '"+methodName+"' method")),ContinueSentinel;var record=tryCatch(method,delegate.iterator,context.arg);if("throw"===record.type)return context.method="throw",context.arg=record.arg,context.delegate=null,ContinueSentinel;var info=record.arg;return info?info.done?(context[delegate.resultName]=info.value,context.next=delegate.nextLoc,"return"!==context.method&&(context.method="next",context.arg=void 0),context.delegate=null,ContinueSentinel):info:(context.method="throw",context.arg=new TypeError("iterator result is not an object"),context.delegate=null,ContinueSentinel)}function pushTryEntry(locs){var entry={tryLoc:locs[0]};1 in locs&&(entry.catchLoc=locs[1]),2 in locs&&(entry.finallyLoc=locs[2],entry.afterLoc=locs[3]),this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal",delete record.arg,entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}],tryLocsList.forEach(pushTryEntry,this),this.reset(!0)}function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod.call(iterable);if("function"==typeof iterable.next)return iterable;if(!isNaN(iterable.length)){var i=-1,next=function next(){for(;++i<iterable.length;)if(hasOwn.call(iterable,i))return next.value=iterable[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return next.next=next}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,defineProperty(Gp,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),defineProperty(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,toStringTagSymbol,"GeneratorFunction"),exports.isGeneratorFunction=function(genFun){var ctor="function"==typeof genFun&&genFun.constructor;return!!ctor&&(ctor===GeneratorFunction||"GeneratorFunction"===(ctor.displayName||ctor.name))},exports.mark=function(genFun){return Object.setPrototypeOf?Object.setPrototypeOf(genFun,GeneratorFunctionPrototype):(genFun.__proto__=GeneratorFunctionPrototype,define(genFun,toStringTagSymbol,"GeneratorFunction")),genFun.prototype=Object.create(Gp),genFun},exports.awrap=function(arg){return{__await:arg}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,asyncIteratorSymbol,(function(){return this})),exports.AsyncIterator=AsyncIterator,exports.async=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){void 0===PromiseImpl&&(PromiseImpl=Promise);var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then((function(result){return result.done?result.value:iter.next()}))},defineIteratorMethods(Gp),define(Gp,toStringTagSymbol,"Generator"),define(Gp,iteratorSymbol,(function(){return this})),define(Gp,"toString",(function(){return"[object Generator]"})),exports.keys=function(val){var object=Object(val),keys=[];for(var key in object)keys.push(key);return keys.reverse(),function next(){for(;keys.length;){var key=keys.pop();if(key in object)return next.value=key,next.done=!1,next}return next.done=!0,next}},exports.values=values,Context.prototype={constructor:Context,reset:function reset(skipTempReset){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!skipTempReset)for(var name in this)"t"===name.charAt(0)&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))&&(this[name]=void 0)},stop:function stop(){this.done=!0;var rootRecord=this.tryEntries[0].completion;if("throw"===rootRecord.type)throw rootRecord.arg;return this.rval},dispatchException:function dispatchException(exception){if(this.done)throw exception;var context=this;function handle(loc,caught){return record.type="throw",record.arg=exception,context.next=loc,caught&&(context.method="next",context.arg=void 0),!!caught}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i],record=entry.completion;if("root"===entry.tryLoc)return handle("end");if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc"),hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}else if(hasCatch){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0)}else{if(!hasFinally)throw new Error("try statement without catch or finally");if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}}}},abrupt:function abrupt(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break}}finallyEntry&&("break"===type||"continue"===type)&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc&&(finallyEntry=null);var record=finallyEntry?finallyEntry.completion:{};return record.type=type,record.arg=arg,finallyEntry?(this.method="next",this.next=finallyEntry.finallyLoc,ContinueSentinel):this.complete(record)},complete:function complete(record,afterLoc){if("throw"===record.type)throw record.arg;return"break"===record.type||"continue"===record.type?this.next=record.arg:"return"===record.type?(this.rval=this.arg=record.arg,this.method="return",this.next="end"):"normal"===record.type&&afterLoc&&(this.next=afterLoc),ContinueSentinel},finish:function finish(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc)return this.complete(entry.completion,entry.afterLoc),resetTryEntry(entry),ContinueSentinel}},catch:function _catch(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if("throw"===record.type){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(iterable,resultName,nextLoc){return this.delegate={iterator:values(iterable),resultName,nextLoc},"next"===this.method&&(this.arg=void 0),ContinueSentinel}},exports}function jsonSchemaLinter_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function getPropertyNameCursor(node){if("Property"===node.name){var cursor=node.cursor();return cursor.next(),cursor}}function jsonSchemaLinter(editor,schema){var rootSchema=null!=schema&&schema.$ref?editor.draft.getSchema():schema,draft=new dist_module.nu(editor.draft.config,rootSchema),localSchema=draft.compileSchema(schema);return function(){var _ref=function jsonSchemaLinter_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){jsonSchemaLinter_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){jsonSchemaLinter_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(jsonSchemaLinter_regeneratorRuntime().mark((function _callee(view){var jsonLint,jsonLintResult;return jsonSchemaLinter_regeneratorRuntime().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(jsonLint=(0,dist.ap)(),!((jsonLintResult=jsonLint(view)).length>0)){_context.next=4;break}return _context.abrupt("return",jsonLintResult);case 4:return _context.abrupt("return",runJsonSchemaLinter(draft,localSchema,view));case 5:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref.apply(this,arguments)}}()}function runJsonSchemaLinter(draft,schema,view){var currentData=JSON.parse(view.state.doc.toString()),errors=draft.validate(currentData,schema);if(0===errors.length)return[];var tree=(0,language_dist.qz)(view.state),locationMap=buildJsonPointerMap(view.state.doc,tree.cursor()),duplicateProperties=jsonLintPropertyDuplicates(view.state.doc,tree.cursor()),validationErrors=errors.map((function(error){var _error$data,_error$data2,_error$data3,flagPropertyNameOnly=!1,flagPropertyValueOnly=!0,pointer=null===(_error$data=error.data)||void 0===_error$data?void 0:_error$data.pointer;"no-additional-properties-error"===error.code?(pointer=jsonPointer_default().join(null===(_error$data2=error.data)||void 0===_error$data2?void 0:_error$data2.pointer,null===(_error$data3=error.data)||void 0===_error$data3?void 0:_error$data3.property),flagPropertyNameOnly=!0):"min-length-error"===error.code&&(flagPropertyValueOnly=!0);var propertyLocation=locationMap[pointer];if(null==propertyLocation)return console.warn("Failed resolving node",propertyLocation),{from:0,to:0,severity:"error",message:error.message};var from=propertyLocation.from,to=propertyLocation.to;if(flagPropertyNameOnly){var propertyNameCursor=getPropertyNameCursor(propertyLocation.node);propertyNameCursor&&(from=propertyNameCursor.from,to=propertyNameCursor.to)}else if(flagPropertyValueOnly){var propertyValueCursor=function getPropertyValueCursor(node){var cursor=getPropertyNameCursor(node);if(cursor)return cursor.nextSibling(),cursor}(propertyLocation.node);propertyValueCursor&&(from=propertyValueCursor.from,to=propertyValueCursor.to)}return{from,to,severity:"error",message:error.message}}));return duplicateProperties.length>0&&validationErrors.push.apply(validationErrors,jsonSchemaLinter_toConsumableArray(duplicateProperties)),validationErrors.filter((function(err){return null!=err}))}var view_dist=__webpack_require__("./node_modules/@codemirror/view/dist/index.js");function jsonSchemaTooltip_typeof(obj){return jsonSchemaTooltip_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},jsonSchemaTooltip_typeof(obj)}function jsonSchemaTooltip_regeneratorRuntime(){jsonSchemaTooltip_regeneratorRuntime=function _regeneratorRuntime(){return exports};var exports={},Op=Object.prototype,hasOwn=Op.hasOwnProperty,defineProperty=Object.defineProperty||function(obj,key,desc){obj[key]=desc.value},$Symbol="function"==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||"@@iterator",asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator",toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";function define(obj,key,value){return Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}),obj[key]}try{define({},"")}catch(err){define=function define(obj,key,value){return obj[key]=value}}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator,generator=Object.create(protoGenerator.prototype),context=new Context(tryLocsList||[]);return defineProperty(generator,"_invoke",{value:makeInvokeMethod(innerFn,self,context)}),generator}function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}exports.wrap=wrap;var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};define(IteratorPrototype,iteratorSymbol,(function(){return this}));var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);function defineIteratorMethods(prototype){["next","throw","return"].forEach((function(method){define(prototype,method,(function(arg){return this._invoke(method,arg)}))}))}function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if("throw"!==record.type){var result=record.arg,value=result.value;return value&&"object"==jsonSchemaTooltip_typeof(value)&&hasOwn.call(value,"__await")?PromiseImpl.resolve(value.__await).then((function(value){invoke("next",value,resolve,reject)}),(function(err){invoke("throw",err,resolve,reject)})):PromiseImpl.resolve(value).then((function(unwrapped){result.value=unwrapped,resolve(result)}),(function(error){return invoke("throw",error,resolve,reject)}))}reject(record.arg)}var previousPromise;defineProperty(this,"_invoke",{value:function value(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl((function(resolve,reject){invoke(method,arg,resolve,reject)}))}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(innerFn,self,context){var state="suspendedStart";return function(method,arg){if("executing"===state)throw new Error("Generator is already running");if("completed"===state){if("throw"===method)throw arg;return doneResult()}for(context.method=method,context.arg=arg;;){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult}}if("next"===context.method)context.sent=context._sent=context.arg;else if("throw"===context.method){if("suspendedStart"===state)throw state="completed",context.arg;context.dispatchException(context.arg)}else"return"===context.method&&context.abrupt("return",context.arg);state="executing";var record=tryCatch(innerFn,self,context);if("normal"===record.type){if(state=context.done?"completed":"suspendedYield",record.arg===ContinueSentinel)continue;return{value:record.arg,done:context.done}}"throw"===record.type&&(state="completed",context.method="throw",context.arg=record.arg)}}}function maybeInvokeDelegate(delegate,context){var methodName=context.method,method=delegate.iterator[methodName];if(void 0===method)return context.delegate=null,"throw"===methodName&&delegate.iterator.return&&(context.method="return",context.arg=void 0,maybeInvokeDelegate(delegate,context),"throw"===context.method)||"return"!==methodName&&(context.method="throw",context.arg=new TypeError("The iterator does not provide a '"+methodName+"' method")),ContinueSentinel;var record=tryCatch(method,delegate.iterator,context.arg);if("throw"===record.type)return context.method="throw",context.arg=record.arg,context.delegate=null,ContinueSentinel;var info=record.arg;return info?info.done?(context[delegate.resultName]=info.value,context.next=delegate.nextLoc,"return"!==context.method&&(context.method="next",context.arg=void 0),context.delegate=null,ContinueSentinel):info:(context.method="throw",context.arg=new TypeError("iterator result is not an object"),context.delegate=null,ContinueSentinel)}function pushTryEntry(locs){var entry={tryLoc:locs[0]};1 in locs&&(entry.catchLoc=locs[1]),2 in locs&&(entry.finallyLoc=locs[2],entry.afterLoc=locs[3]),this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal",delete record.arg,entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}],tryLocsList.forEach(pushTryEntry,this),this.reset(!0)}function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod.call(iterable);if("function"==typeof iterable.next)return iterable;if(!isNaN(iterable.length)){var i=-1,next=function next(){for(;++i<iterable.length;)if(hasOwn.call(iterable,i))return next.value=iterable[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return next.next=next}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,defineProperty(Gp,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),defineProperty(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,toStringTagSymbol,"GeneratorFunction"),exports.isGeneratorFunction=function(genFun){var ctor="function"==typeof genFun&&genFun.constructor;return!!ctor&&(ctor===GeneratorFunction||"GeneratorFunction"===(ctor.displayName||ctor.name))},exports.mark=function(genFun){return Object.setPrototypeOf?Object.setPrototypeOf(genFun,GeneratorFunctionPrototype):(genFun.__proto__=GeneratorFunctionPrototype,define(genFun,toStringTagSymbol,"GeneratorFunction")),genFun.prototype=Object.create(Gp),genFun},exports.awrap=function(arg){return{__await:arg}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,asyncIteratorSymbol,(function(){return this})),exports.AsyncIterator=AsyncIterator,exports.async=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){void 0===PromiseImpl&&(PromiseImpl=Promise);var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then((function(result){return result.done?result.value:iter.next()}))},defineIteratorMethods(Gp),define(Gp,toStringTagSymbol,"Generator"),define(Gp,iteratorSymbol,(function(){return this})),define(Gp,"toString",(function(){return"[object Generator]"})),exports.keys=function(val){var object=Object(val),keys=[];for(var key in object)keys.push(key);return keys.reverse(),function next(){for(;keys.length;){var key=keys.pop();if(key in object)return next.value=key,next.done=!1,next}return next.done=!0,next}},exports.values=values,Context.prototype={constructor:Context,reset:function reset(skipTempReset){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!skipTempReset)for(var name in this)"t"===name.charAt(0)&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))&&(this[name]=void 0)},stop:function stop(){this.done=!0;var rootRecord=this.tryEntries[0].completion;if("throw"===rootRecord.type)throw rootRecord.arg;return this.rval},dispatchException:function dispatchException(exception){if(this.done)throw exception;var context=this;function handle(loc,caught){return record.type="throw",record.arg=exception,context.next=loc,caught&&(context.method="next",context.arg=void 0),!!caught}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i],record=entry.completion;if("root"===entry.tryLoc)return handle("end");if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc"),hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}else if(hasCatch){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0)}else{if(!hasFinally)throw new Error("try statement without catch or finally");if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}}}},abrupt:function abrupt(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break}}finallyEntry&&("break"===type||"continue"===type)&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc&&(finallyEntry=null);var record=finallyEntry?finallyEntry.completion:{};return record.type=type,record.arg=arg,finallyEntry?(this.method="next",this.next=finallyEntry.finallyLoc,ContinueSentinel):this.complete(record)},complete:function complete(record,afterLoc){if("throw"===record.type)throw record.arg;return"break"===record.type||"continue"===record.type?this.next=record.arg:"return"===record.type?(this.rval=this.arg=record.arg,this.method="return",this.next="end"):"normal"===record.type&&afterLoc&&(this.next=afterLoc),ContinueSentinel},finish:function finish(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc)return this.complete(entry.completion,entry.afterLoc),resetTryEntry(entry),ContinueSentinel}},catch:function _catch(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if("throw"===record.type){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(iterable,resultName,nextLoc){return this.delegate={iterator:values(iterable),resultName,nextLoc},"next"===this.method&&(this.arg=void 0),ContinueSentinel}},exports}function jsonSchemaTooltip_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}var jsonSchemaTooltip_dom=document.createElement("div"),jsonSchemaTooltip_root=(0,client.createRoot)(jsonSchemaTooltip_dom);function jsonSchemaTooltip_getData(doc){try{return JSON.parse(doc.toString())}catch(e){return}}var jsonSchemaTooltip=function jsonSchemaTooltip(editor){var nodePointer=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#",localSchema=arguments.length>2?arguments[2]:void 0;return(0,view_dist.bF)(function(){var _ref=function jsonSchemaTooltip_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){jsonSchemaTooltip_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){jsonSchemaTooltip_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(jsonSchemaTooltip_regeneratorRuntime().mark((function _callee(view,pos,side){var _getJsonPointerFromPo,pointer,cursor,location,absolutePointer,data,schema;return jsonSchemaTooltip_regeneratorRuntime().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(_getJsonPointerFromPo=getJsonPointerFromPosition(view.state,pos),pointer=_getJsonPointerFromPo.pointer,cursor=_getJsonPointerFromPo.cursor,location=_getJsonPointerFromPo.location,absolutePointer=localSchema?"#".concat(pointer):"".concat(nodePointer).concat(pointer),data=jsonSchemaTooltip_getData(view.state.doc),"error"!==(schema=editor.draft.getSchema("".concat(absolutePointer),data,localSchema)).type&&"value"!==location){_context.next=6;break}return _context.abrupt("return",null);case 6:if(null!=schema.title||null!=schema.description){_context.next=8;break}return _context.abrupt("return",null);case 8:return _context.abrupt("return",{pos:cursor.from,end:cursor.to,above:!0,create:function create(view){return jsonSchemaTooltip_root.render((0,jsx_runtime.jsxs)("div",{className:"rje-tooltip rje-tooltip--jsonschema",children:[schema.title&&(0,jsx_runtime.jsx)("h1",{children:schema.title}),schema.description&&(0,jsx_runtime.jsx)(index_modern.Z,{children:schema.description})]})),{dom:jsonSchemaTooltip_dom}}});case 9:case"end":return _context.stop()}}),_callee)})));return function(_x,_x2,_x3){return _ref.apply(this,arguments)}}())},lint_dist=__webpack_require__("./node_modules/@codemirror/lint/dist/index.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||function useCodeMirrorOnBlur_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return useCodeMirrorOnBlur_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return useCodeMirrorOnBlur_arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function useCodeMirrorOnBlur_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function useCodeMirrorOnBlur(onBlur,pointer){var _useState2=_slicedToArray((0,react.useState)(),2),codeMirror=_useState2[0],setCodeMirror=_useState2[1],ref=(0,react.useCallback)((function(editor){null!=editor&&setCodeMirror(editor)}),[]);return(0,react.useEffect)((function(){var _codeMirror$view,contentDOM=null==codeMirror||null===(_codeMirror$view=codeMirror.view)||void 0===_codeMirror$view?void 0:_codeMirror$view.contentDOM;if(null!=contentDOM&&null!=onBlur){var valueFromEvent=function valueFromEvent(event){var dom=event.target;dom.innerText&&onBlur&&onBlur(dom.innerText)};return contentDOM.addEventListener("blur",valueFromEvent),function(){null==contentDOM||contentDOM.removeEventListener("blur",valueFromEvent)}}}),[codeMirror,onBlur]),[ref]}function JsonWidget_typeof(obj){return JsonWidget_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},JsonWidget_typeof(obj)}function JsonWidget_slicedToArray(arr,i){return function JsonWidget_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function JsonWidget_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||function JsonWidget_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return JsonWidget_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return JsonWidget_arrayLikeToArray(o,minLen)}(arr,i)||function JsonWidget_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function JsonWidget_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return(key=function _toPropertyKey(arg){var key=function _toPrimitive(input,hint){if("object"!==JsonWidget_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==JsonWidget_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===JsonWidget_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var InvalidJsonError={type:"error",name:"InvalidJsonError",code:"invalid-json-error",message:"Invalid json format. Changes will be applied only if the json is valid."},JsonWidget=function JsonWidget(props){return"string"===props.node.schema.type?(0,jsx_runtime.jsx)(JsonStringWidget,_objectSpread({},props)):(0,jsx_runtime.jsx)(JsonDataWidget,_objectSpread({},props))};JsonWidget.displayName="JsonWidget";var JsonDataWidget=(0,src.Zg)((function(_ref){var _options$theme,node=_ref.node,options=_ref.options,editor=_ref.editor,setValue=_ref.setValue,_useState2=JsonWidget_slicedToArray((0,react.useState)(!0),2),validJson=_useState2[0],setJsonValid=_useState2[1],onChange=(0,react.useCallback)((function(value){try{setValue(JSON.parse(value)),setJsonValid(!0)}catch(e){console.log("failed parsing value"),setJsonValid(!1)}}),[setValue]),ref=JsonWidget_slicedToArray(useCodeMirrorOnBlur(onChange,node.pointer),1)[0],onChangeListener={};options.liveUpdate?onChangeListener.onChange=onChange:onChangeListener.ref=ref;var extensions=[(0,dist.AV)(),dist.bA.data.of({autocomplete:jsonSchemaCompletion(editor.draft,node.schema)}),(0,lint_dist.Q2)(),(0,lint_dist.ir)(jsonSchemaLinter(editor,node.schema||{})),jsonSchemaTooltip(editor,node.pointer)];return(0,jsx_runtime.jsxs)(src.$L.Field,{widgetType:"json",node,options,additionalError:validJson?void 0:InvalidJsonError,showDescription:!1,children:[(0,jsx_runtime.jsx)(src.__,{children:options.title}),(0,jsx_runtime.jsx)(esm.ZP,_objectSpread(_objectSpread({value:JSON.stringify((0,src.AV)(node),null,2),basicSetup:options.setup,editable:!1===options.disabled,extensions,height:options.height,minHeight:options.minHeight,maxHeight:options.maxHeight,indentWithTab:options.indentWithTab,placeholder:options.placeholder,readOnly:options.readOnly,theme:null!==(_options$theme=options.theme)&&void 0!==_options$theme?_options$theme:"light"},onChangeListener),{},{style:{border:"1px solid silver"}})),options.description&&(0,jsx_runtime.jsx)(src.$L.Description,{children:(0,jsx_runtime.jsx)(index_modern.Z,{children:options.description})})]})})),JsonStringWidget=(0,src.Zg)((function(_ref2){var _options$theme2,node=_ref2.node,options=_ref2.options,editor=_ref2.editor,setValue=_ref2.setValue,_useState4=JsonWidget_slicedToArray((0,react.useState)(!0),2),validJson=_useState4[0],setJsonValid=_useState4[1],onChange=(0,react.useCallback)((function(value){try{JSON.parse(value),setValue(value),setJsonValid(!0)}catch(e){console.log("failed parsing value"),setJsonValid(!1)}}),[setValue]),tooltip=(0,react.useMemo)((function(){return jsonSchemaTooltip(editor,node.pointer,options.schema)}),[]),extensions=[(0,dist.AV)(),(0,lint_dist.Q2)(),(0,lint_dist.ir)(jsonSchemaLinter(editor,options.schema||{}))];options.schema&&extensions.push(tooltip,dist.bA.data.of({autocomplete:jsonSchemaCompletion(editor.draft,options.schema)}));var ref=JsonWidget_slicedToArray(useCodeMirrorOnBlur(onChange,node.pointer),1)[0],onChangeListener={};return options.liveUpdate?onChangeListener.onChange=onChange:onChangeListener.ref=ref,(0,jsx_runtime.jsxs)(src.$L.Field,{widgetType:"json",node,options,additionalError:validJson?void 0:InvalidJsonError,showDescription:!1,children:[(0,jsx_runtime.jsx)(src.__,{children:options.title}),(0,jsx_runtime.jsx)(esm.ZP,_objectSpread(_objectSpread({value:node.value,basicSetup:options.setup,editable:!1===options.disabled,extensions,height:options.height,minHeight:options.minHeight,maxHeight:options.maxHeight,indentWithTab:options.indentWithTab,placeholder:options.placeholder,readOnly:options.readOnly,theme:null!==(_options$theme2=options.theme)&&void 0!==_options$theme2?_options$theme2:"light"},onChangeListener),{},{style:{border:"1px solid silver"}})),options.description&&(0,jsx_runtime.jsx)(src.$L.Description,{children:(0,jsx_runtime.jsx)(index_modern.Z,{children:options.description})})]})})),JsonWidgetPlugin={id:"json-widget",use:function use(_ref3,options){var schema=_ref3.schema;return"json"===(null==options?void 0:options.widget)||"json"===schema.format},Widget:JsonWidget};try{JsonWidget.displayName="JsonWidget",JsonWidget.__docgenInfo={description:"",displayName:"JsonWidget",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/rje-code-widgets/src/lib/jsonwidget/JsonWidget.tsx#JsonWidget"]={docgenInfo:JsonWidget.__docgenInfo,name:"JsonWidget",path:"packages/rje-code-widgets/src/lib/jsonwidget/JsonWidget.tsx#JsonWidget"})}catch(__react_docgen_typescript_loader_error){}try{JsonDataWidget.displayName="JsonDataWidget",JsonDataWidget.__docgenInfo={description:"",displayName:"JsonDataWidget",props:{node:{defaultValue:null,description:"",name:"node",required:!0,type:{name:"ParentNode<JsonWidgetOptions>"}},editor:{defaultValue:null,description:"",name:"editor",required:!0,type:{name:"JsonEditor"}},options:{defaultValue:null,description:"",name:"options",required:!1,type:{name:"Partial<JsonWidgetOptions>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/rje-code-widgets/src/lib/jsonwidget/JsonWidget.tsx#JsonDataWidget"]={docgenInfo:JsonDataWidget.__docgenInfo,name:"JsonDataWidget",path:"packages/rje-code-widgets/src/lib/jsonwidget/JsonWidget.tsx#JsonDataWidget"})}catch(__react_docgen_typescript_loader_error){}try{JsonStringWidget.displayName="JsonStringWidget",JsonStringWidget.__docgenInfo={description:"",displayName:"JsonStringWidget",props:{node:{defaultValue:null,description:"",name:"node",required:!0,type:{name:"StringNode<JsonWidgetOptions>"}},editor:{defaultValue:null,description:"",name:"editor",required:!0,type:{name:"JsonEditor"}},options:{defaultValue:null,description:"",name:"options",required:!1,type:{name:"Partial<JsonWidgetOptions>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/rje-code-widgets/src/lib/jsonwidget/JsonWidget.tsx#JsonStringWidget"]={docgenInfo:JsonStringWidget.__docgenInfo,name:"JsonStringWidget",path:"packages/rje-code-widgets/src/lib/jsonwidget/JsonWidget.tsx#JsonStringWidget"})}catch(__react_docgen_typescript_loader_error){}},"./packages/rje-widgets/src/lib/theme.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__={"--rje-font-family":"Inter, sans-serif","--rje-color-light-primary":"31, 101, 141","--rje-color-light-secondary":"9, 66, 98","--rje-color-light-text":"7, 23, 32","--rje-color-dark-primary":"50, 133, 180","--rje-color-dark-secondary":"145, 192, 218","--rje-color-dark-text":"235, 240, 241"}}}]);